<!doctype html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=en><![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang=en><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang=en><![endif]--><!--[if gt IE 8]><!--><html class=no-js lang=en><!--<![endif]--><head><meta charset=utf-8><title>Cloud &#8211; Le murmure de Julian</title><meta name=description content><meta property="og:title" content="Cloud"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="http://blog.jln.co/tags/Cloud/"><meta property="og:image" content="http://blog.jln.co/images/avatar.png"><meta property="og:updated_time" content="2011-09-29T01:11:11+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://blog.jln.co/images/avatar.png"><meta name=twitter:title content="Cloud"><meta name=twitter:description content><link rel=canonical href=http://blog.jln.co/tags/Cloud/><link href=http://blog.jln.co/tags/Cloud/feed.xml rel=alternate type=application/rss+xml title="Le murmure de Julian"><link href=http://blog.jln.co/tags/Cloud/feed.xml rel=feed type=application/rss+xml title="Le murmure de Julian"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/main.css><link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel=stylesheet type=text/css><meta http-equiv=cleartype content="on"><meta name=generator content="Hugo 0.73.0"><script src=/js/vendor/modernizr-2.6.2.custom.min.js></script><script async src=https://unpkg.com/mermaid@8.2.3/dist/mermaid.min.js></script><link rel="shortcut icon" href=/favicon.png></head><body id=post-index><nav id=dl-menu class=dl-menuwrapper role=navigation style=display:inline-block><button class=dl-trigger>Open Menu</button><ul class=dl-menu><li><a href=/>Home</a></li><li><a href=#>About</a><ul class=dl-submenu><li><img src=/images/avatar.png alt="Julian Shen's photo" class=author-photo><h4>Julian Shen</h4><p>Softward developer</p></li><li><a href=mailto:julianshen22@gmail.com><i class="fa fa-fw fa-envelope"></i>Email</a></li><li><a href=https://linkedin.com/in/julianshen><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a></li><li><a href=https://github.com/julianshen><i class="fa fa-fw fa-github"></i>GitHub</a></li><li><a href=https://instagram.com/julianshen><i class="fa fa-fw fa-instagram"></i>Instagram</a></li></ul></li><li><a href=#>Posts</a><ul class=dl-submenu><li><a href=/post/>All Posts</a></li><li><a href=/tags/>All Tags</a></li></ul></li><li><a href=/></a></li></ul></nav><div class=entry-header><div class=header-title><div class=header-title-wrap><h1><a href=/ title="Go to the homepage">Le murmure de Julian</a></h1><h2>Cloud</h2></div></div></div><div id=main role=main><article class=hentry><header><div class=entry-meta><span class="entry-date date published updated"><time datetime="2011-09-29 01:11:11 +0000 UTC"><a href=/%E7%AD%86%E8%A8%98-Building-social-networking-service-with-DIASPORA-on-Heroku/>Sep 29, 2011</a></time></span>
<span class=entry-reading-time><i class="fa fa-clock-o"></i>Reading time ~1 minute</span></div><h1 class=entry-title><a href=/%E7%AD%86%E8%A8%98-Building-social-networking-service-with-DIASPORA-on-Heroku/ rel=bookmark title="[筆記] Building social networking service with DIASPORA* on Heroku" itemprop=url>[筆記] Building social networking service with DIASPORA* on Heroku</a></h1></header><div class=entry-content><div class=posterous_autopost><div class="p_embed p_image_embed"><a href=http://posterous.com/getfile/files.posterous.com/temp-2011-09-28/yDcrGkHznnvkFfkhEjoabkEryHGaevvynvtyCEGosBbuinEijbvqtaehCjpq/_2011-09-29_12.03.19.png.scaled1000.png><img alt=_2011-09-29_12 height=392 src=http://posterous.com/getfile/files.posterous.com/temp-2011-09-28/yDcrGkHznnvkFfkhEjoabkEryHGaevvynvtyCEGosBbuinEijbvqtaehCjpq/_2011-09-29_12.03.19.png.scaled500.png width=500></a></div><p>Looks familiar? It&rsquo;s not Google+. It&rsquo;s <a href=https://joindiaspora.com/>DIASPORA</a>. An open source project that implements a distributed social networking service. This project was announced on APRIL 24, 2010 (Just right after Facebook f8 2010 that is at APRIL 21). Alpha version was released at NOV 23, 2010 (two days before my birthday :P). </p><p>According to <a href=http://mashable.com/2010/05/28/zuckerberg-diaspora/>this</a>, Mark Zuckerbug also donated to it just because it&rsquo;s a cool idea.</p><p>It&rsquo;s built on Ruby on rails. So it might be not so difficult to port it to Heroku platform which is a nice RoR host (althrough it still took me some time). It might be easier than build from scratch on a Linux. </p><p>I&rsquo;m a newbie to these two (Heroku and DIASPORA). I&rsquo;m also not familar with RoR. Here records steps I tried. </p><p><span style=font-size:medium><strong>create an application on heroku</strong></span></p><p>First, you need to create an application on Heroku. There are several platform stack on Heroku. <a href=http://devcenter.heroku.com/articles/cedar>Cedar stack</a> might be the newest and most powerful one. It supports several languages and frameworks. And It also makes it very easy to deploy RoR applications. </p><p>You need to <a href=http://devcenter.heroku.com/articles/heroku-command>install heroku CLI</a> before creating an application. And use &ldquo;<em>heroku login</em>&rdquo; to login to your heroku account.</p><p>Run the following command to create a new cedar application (assume application name is &ldquo;mysocialy&rdquo;) &ndash;</p><blockquote class=posterous_short_quote><p><em>heroku create &ndash;stack cedar mysocialy</em></p></blockquote><p>After the application created, you&rsquo;ll have a url <em>&ldquo;http://mysocialy.herokuapp.com/&rdquo;</em> for your site. And a git repository: <em><a href=mailto:git@heroku.com>git@heroku.com</a>:mysocialy.git</em></p><p><span style=font-size:medium><em><strong>import source codes</strong></em></span></p><p>Get DIASPORA* source codes from git hub:</p><blockquote class=posterous_short_quote><p><em>git clone git://github.com/diaspora/diaspora.git</em></p></blockquote><p>Get your source codes from Heroku git repository (you&rsquo;ll get an empty folder):</p><blockquote class=posterous_short_quote><p><em>git clone </em><em><a href=mailto:git@heroku.com>git@heroku.com</a>:mysocialy.git</em></p></blockquote><p>If you have trouble to download from Heroku. Try to use &ldquo;<em>heroku keys:add</em>&rdquo; to add your ssh public key and try again.</p><p>Copy all files except &ldquo;.git&rdquo; folder from &ldquo;diaspora&rdquo; to &ldquo;mysocialy&rdquo;.</p><p><span style=font-size:medium><em><strong>Initial configuration</strong></em></span></p><p>Make new configuration files from example.</p><blockquote class=posterous_short_quote><p><em>cd config</em></p><p><em>mv application.yml.example application.yml  </em></p><p><em>mv database.yml.example database.yml</em></p></blockquote><p>Edit application.yml. Make &ldquo;pod_url&rdquo; to your host. In this case:</p><blockquote class=posterous_short_quote><p><em>pod_url: &ldquo;http://mysocialy.herokuapp.com/&rdquo;</em></p></blockquote><p><em><strong><span style=font-size:medium>Deploy codes</span></strong></em></p><p>Add and commit files:</p><blockquote class=posterous_short_quote><p><em>git add .</em></p><p><em>git commit -am &lsquo;initial import&rsquo;</em></p></blockquote><p>Push them to Heroku</p><blockquote class=posterous_short_quote><p><em>git push origin master</em></p></blockquote><p>The coolest thing that Heroku does is that it makes deploy codes so easy. All you need to do is to push your codes to its git repository. And it could also install all related modules for you (that is configured in Gemfile). Super easy.</p><p>Ok, I must admit that I lie a little bit. There might be some problems. After I pushes all codes to Heroku, I found there is an error that it couldn&rsquo;t find 'pg&rsquo; (postgresSQL). Looks like it does not install into gem.</p><p>I found the answer that it might be problem with gem version. Need to run &ldquo;<em>bundle install</em>&rdquo; at local.  This will generate a new Gemfile.lock. Push this new file to Heroku might solve this problem</p><p><em><span style=font-size:medium><strong>Ok, that&rsquo;s all?</strong></span></em></p><p>Not sure if I missed anything (I might). Anyway, what I did is alive at &ldquo;<em><a href=http://mysocialy.herokuapp.com/>http://mysocialy.herokuapp.com/</a>&rdquo;.</em></p></div></div></article><article class=hentry><header><div class=entry-meta><span class="entry-date date published updated"><time datetime="2011-09-23 05:27:32 +0000 UTC"><a href=/%E5%9C%A8Heroku%E4%B8%8A%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B%E4%BB%A5Node.js%E9%96%8B%E7%99%BC%E7%9A%84Facebook%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F/>Sep 23, 2011</a></time></span>
<span class=entry-reading-time><i class="fa fa-clock-o"></i>Reading time ~3 minutes</span></div><h1 class=entry-title><a href=/%E5%9C%A8Heroku%E4%B8%8A%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B%E4%BB%A5Node.js%E9%96%8B%E7%99%BC%E7%9A%84Facebook%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F/ rel=bookmark title=在Heroku上建立一個以Node.js開發的Facebook應用程式 itemprop=url>在Heroku上建立一個以Node.js開發的Facebook應用程式</a></h1></header><div class=entry-content><div class=posterous_autopost><p>這篇算筆記, 有可能會有一些失落環節在, 主要從create Facebook application到可以在local端執行</p><p>Facebook這月稍早時跟Heroku合作, 讓建立一個Facebook應用程式(含後端)更加方便: <a href=http://developers.facebook.com/blog/post/558/>http://developers.facebook.com/blog/post/558/</a> (有些步驟可以從這看)</p><p>我選了Node.js當做開發的平台, 以下就是我的步驟:</p><p><strong>建立Facebook application</strong></p><p>首先到Facebook application page <a href=https://developers.facebook.com/apps/>https://developers.facebook.com/apps/</a> 建立一個新的應用程式</p><p>跟以往有點不太一樣的是, 在Application settings裡面多了一個"Cloud Services" -</p><div class="p_embed p_image_embed"><a href=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/BDvdiEImAAhdFjwgFIvsdiEjirfmjdjcjntJBkIqeyIuebqojvhpAvgHfEpE/_2011-09-21_4.33.20.png.scaled1000.png><img alt=_2011-09-21_4 height=234 src=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/BDvdiEImAAhdFjwgFIvsdiEjirfmjdjcjntJBkIqeyIuebqojvhpAvgHfEpE/_2011-09-21_4.33.20.png.scaled500.png width=500></a></div><p>目前只有Heroku可以選, 我猜以後搞不好會有更多合作對象吧</p><p>選了Provider之後, 接下來就要選擇平台, 目前有PHP, Python, Ruby, Node.js可選, 選擇算蠻多的了, 這邊選Node.js</p><div class="p_embed p_image_embed"><a href=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/hpJIEgltHgcipFzBHplDekcrqltlgpFIwazgECxoamGjIaaynpzkHbeJtdrl/_2011-09-21_4.33.34.png.scaled1000.png><img alt=_2011-09-21_4 height=257 src=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/hpJIEgltHgcipFzBHplDekcrqltlgpFIwazgECxoamGjIaaynpzkHbeJtdrl/_2011-09-21_4.33.34.png.scaled500.png width=500></a></div><p>經過一些有的沒的之後, 就會有這畫面, 這邊已經完成這個應用程式的基本雛形了</p><div class="p_embed p_image_embed"><a href=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/zurDvaqBIrlJCHmdoGFIsFqgxhIImBDIFHrmwxlmralAzGiwzAgmhsiwedJv/_2011-09-21_4.34.54.png.scaled1000.png><img alt=_2011-09-21_4 height=441 src=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/zurDvaqBIrlJCHmdoGFIsFqgxhIImBDIFHrmwxlmralAzGiwzAgmhsiwedJv/_2011-09-21_4.34.54.png.scaled500.png width=500></a></div><p><strong>設定你的heroku應用程式</strong></p><p>到 <a href=https://api.heroku.com/myapps>https://api.heroku.com/myapps</a> 去設定你的應用程式, 在這邊你可以修改應用程式名稱, 不過比較麻煩的是, 這邊的修改並不會同步回Facebok, 因此修改後還是需要回Facebook去更改相關設定:</p><div class="p_embed p_image_embed"><a href=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/stfjuojfjhffmFIxjFxngtFixshyltfzCdGpmqmCHdhymokGGpHmIIGloDew/_2011-09-21_4.36.09.png.scaled1000.png><img alt=_2011-09-21_4 height=222 src=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/stfjuojfjhffmFIxjFxngtFixshyltfzCdGpmqmCHdhymokGGpHmIIGloDew/_2011-09-21_4.36.09.png.scaled500.png width=500></a></div><p><strong>在你的電腦執行</strong></p><p>一般在程式沒完成前大多都不會想直接佈署上去, 能在自己電腦先執行驗證過是比較容易抓蟲的</p><p>以下是先需要安裝的</p><p><em><strong>heroku command line -</strong></em></p><p>heroku是用gem安裝的, 所以安裝前要先確認你電腦有沒安裝Ruby, heroku安裝方法很簡單, 只要執行 &ldquo;gem install heroku&rdquo;</p><p>安裝好後先用"heroku keys"看看有沒存在的key, 有的話可能會讓之後要用git抓資料有問題, 有的話用"heoku keys:remove"先移除, 這樣login會產生新的public key</p><p>用"heroku login"登入heroku, 第一次使用可能會要求產生public key</p><p>登入後就可以用"git clone <a href=mailto:git@heroku.com>git@heroku.com</a>:ff8.git"抓下原始碼(ff8是heroku application name)</p><p><em><strong>node.js -</strong></em></p><p>這當然是必須安裝的(在這例子), 如果是在mac上, 又是brew的使用者, 那只要用"brew install node"即可</p><p><strong><em>npm (node package manager) -</em></strong></p><p>安裝方式很簡單, 只要"curl <a href=http://npmjs.org/install.sh>http://npmjs.org/install.sh</a> | sh"</p><p>安裝好後, 在git clone下來的目錄下"npm install", 它自然會裝好所有所需的package</p><p><strong>foreman -</strong></p><p>文件裡面有建議裝, 不過由於這範例只是一個單純的web, 並沒其他worker, 可以不裝</p><p><em><strong>設定Facebook application</strong></em></p><p>因為要在本地端執行而不是heroku的雲, 所以要把url都指向本地端, 像這樣:</p><div class="p_embed p_image_embed"><a href=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/FqEEloboEvDmoDgktlnevAmioattEtyCttJpfebonwoDcfllFBmCDhjAHhsD/_2011-09-23_5.18.47.png.scaled1000.png><img alt=_2011-09-23_5 height=122 src=http://posterous.com/getfile/files.posterous.com/temp-2011-09-22/FqEEloboEvDmoDgktlnevAmioattEtyCttJpfebonwoDcfllFBmCDhjAHhsD/_2011-09-23_5.18.47.png.scaled500.png width=500></a></div><em><strong>設定環境變數</strong></em><p>export FACEBOOK_APP_ID=122348222122778</p><p>export FACEBOOK_SECRET=1ba1beed9f7b5be9192bf4540c231234</p><p>export PORT=5000</p><p>(我跑在5000)</p><p>如果使用foreman, 就把這些寫在.env中</p><p><strong>執行</strong></p><p>&ldquo;node web.js"就可以將server跑起來(或是foreman start), 然後到http://localhost:5000/就可以看到結果 </p></div></div></article></div><div class=footer-wrapper><footer role=contentinfo><span>Powered by <a href=https://gohugo.io/ rel=nofollow>Hugo</a> using the <a href=https://github.com/dldx/hpstr-hugo-theme rel=nofollow>HPSTR theme</a>.</span></footer></div><script src=//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js></script><script src=https://kit.fontawesome.com/872a53b461.js crossorigin=anonymous></script><script>window.jQuery||document.write('<script src="\/js\/vendor\/jquery-1.9.1.min.js"><\/script>')</script><script src=/js/scripts.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-79243751-1','auto');ga('send','pageview');}</script><div id=fb-root></div><script async defer crossorigin=anonymous src="https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v7.0&appId=293999444006555&autoLogAppEvents=1" nonce=geZSUIUh></script></body></html>